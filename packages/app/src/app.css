/* https://tailwindcss.com/docs/preflight#disabling-preflight */
@layer external, normalize, theme, base, common_components, components, utilities, top_layer;
@import "tailwindcss/theme.css" layer(theme);
@import "tailwindcss/preflight.css" layer(base);
@import "tailwindcss/utilities.css" layer(utilities);

/* Liveblocks styles for AI docs editor */
@import "@liveblocks/react-ui/styles.css";
@import "@liveblocks/react-ui/styles/dark/media-query.css";
@import "@liveblocks/react-tiptap/styles.css";

/* Mantine and BlockNote styles */
@import "@blocknote/core/fonts/inter.css";
@import "@blocknote/mantine/style.css";

@import "tw-animate-css";

@import "@assistant-ui/styles/index.css";

@custom-variant dark (&:is(.dark *));

@layer normalize {
	body {
		margin: 0;
		min-width: 320px;
		height: 100vh;
		overflow: hidden;
	}

	a {
		font-weight: 500;
		color: #646cff;
		text-decoration: inherit;
	}

	a:hover {
		color: #535bf2;
	}

	h1 {
		font-size: 3.2em;
		line-height: 1.1;
	}

	/* Scope button styles to exclude Liveblocks components */
	button {
		border-radius: 8px;
		border: 1px solid transparent;
		padding-inline: 0;
		padding-block: 0;
		font-size: 1em;
		font-weight: 500;
		font-family: inherit;
		background-color: #1a1a1a;
		cursor: pointer;
		transition: border-color 0.25s;
	}

	button {
		border-color: #646cff;
	}

	button:focus,
	button:focus-visible {
		outline: 4px auto -webkit-focus-ring-color;
	}
}

/* shadcn/ui CSS Variables - Light Mode */
:root {
	/* Core shadcn design system variables */
	--background: 0 0% 100%;
	--foreground: var(--gray-000);
	--card: 0 0% 100%;
	--card-foreground: var(--gray-000);
	--popover: 0 0% 100%;
	--popover-foreground: var(--gray-000);
	--primary: var(--gray-050);
	--primary-foreground: var(--gray-700);
	--secondary: var(--gray-600);
	--secondary-foreground: var(--gray-050);
	--muted: var(--gray-600);
	--muted-foreground: 240 3.8% 46.1%;
	--accent: var(--gray-600);
	--accent-foreground: var(--gray-050);
	--destructive: 0 84.2% 60.2%;
	--destructive-foreground: var(--gray-700);
	--border: 240 5.9% 90%;
	--input: 240 5.9% 90%;
	--ring: var(--gray-050);
	--chart-1: 12 76% 61%;
	--chart-2: 173 58% 39%;
	--chart-3: 197 37% 24%;
	--chart-4: 43 74% 66%;
	--chart-5: 27 87% 67%;
	--radius: 0.5rem;

	/* Sidebar specific variables */
	--sidebar: var(--gray-700);
	--sidebar-foreground: var(--gray-100);
	--sidebar-primary: var(--gray-050);
	--sidebar-primary-foreground: var(--gray-700);
	--sidebar-accent: var(--gray-800);
	--sidebar-accent-foreground: var(--gray-050);
	--sidebar-border: 220 13% 91%;
	--sidebar-ring: 217.2 91.2% 59.8%;

	--gray-000: oklch(14.08% 0.0044 285.82);
	--gray-050: oklch(21.03% 0.0059 285.89);
	--gray-100: oklch(27.39% 0.0055 286.03);
	--gray-200: oklch(30% 0.0119 285.81);
	--gray-300: oklch(37.03% 0.0119 285.81);
	--gray-400: oklch(40% 0.0119 285.81);
	--gray-500: oklch(43.77% 0.0119 285.81);
	--gray-600: oklch(71.18% 0.0129 286.07);
	--gray-700: oklch(87.11% 0.0055 286.29);
	--gray-800: oklch(96.74% 0.0013 286.37);
	--gray-900: oklch(98.51% 0 0);
	--gray-950: oklch(100% 0 0);

	--red-300: oklch(35% 0.1331 25.72);
	--red-400: oklch(39.58% 0.1331 25.72);
	--red-500: oklch(45% 0.1331 25.72);

	/* App-specific styles */
	font-family: system-ui, Avenir, Helvetica, Arial, sans-serif;
	line-height: 1.5;
	font-weight: 400;
	font-synthesis: none;
	text-rendering: optimizeLegibility;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

/* shadcn/ui CSS Variables - Dark Mode */
.dark {
	/* Core shadcn design system variables - dark mode */
	--background: var(--gray-000);
	--foreground: var(--gray-700);
	--card: var(--gray-000);
	--card-foreground: var(--gray-700);
	--popover: var(--gray-000);
	--popover-foreground: var(--gray-700);
	--primary: var(--gray-700);
	--primary-foreground: var(--gray-050);
	--secondary: var(--gray-300);
	--secondary-foreground: var(--gray-700);
	--muted: var(--gray-300);
	--muted-foreground: var(--gray-600);
	--accent: var(--gray-300);
	--accent-foreground: var(--gray-700);
	--destructive: var(--red-400);
	--destructive-foreground: var(--gray-700);
	--border: var(--gray-300);
	--input: var(--gray-300);
	--ring: var(--gray-700);
	--chart-1: 220 70% 50%;
	--chart-2: 160 60% 45%;
	--chart-3: 30 80% 55%;
	--chart-4: 280 65% 60%;
	--chart-5: 340 75% 55%;

	/* Sidebar specific variables - dark mode */
	--sidebar: var(--gray-050);
	--sidebar-foreground: var(--gray-800);
	--sidebar-primary: 224.3 76.3% 48%;
	--sidebar-primary-foreground: 0 0% 100%;
	--sidebar-accent: var(--gray-300);
	--sidebar-accent-foreground: var(--gray-800);
	--sidebar-border: var(--gray-300);
	--sidebar-ring: 217.2 91.2% 59.8%;
}

/* Tailwind CSS v4 Theme Mappings */
@theme inline {
	/* Core design system colors */
	--color-background: var(--background);
	--color-foreground: var(--foreground);
	--color-card: var(--card);
	--color-card-foreground: var(--card-foreground);
	--color-popover: var(--popover);
	--color-popover-foreground: var(--popover-foreground);
	--color-primary: var(--primary);
	--color-primary-foreground: var(--primary-foreground);
	--color-secondary: var(--secondary);
	--color-secondary-foreground: var(--secondary-foreground);
	--color-muted: var(--muted);
	--color-muted-foreground: var(--muted-foreground);
	--color-accent: var(--accent);
	--color-accent-foreground: var(--accent-foreground);
	--color-destructive: var(--destructive);
	--color-destructive-foreground: var(--destructive-foreground);
	--color-border: var(--border);
	--color-input: var(--input);
	--color-ring: var(--ring);
	--color-chart-1: hsl(var(--chart-1));
	--color-chart-2: hsl(var(--chart-2));
	--color-chart-3: hsl(var(--chart-3));
	--color-chart-4: hsl(var(--chart-4));
	--color-chart-5: hsl(var(--chart-5));

	/* Sidebar colors */
	--color-sidebar: var(--sidebar);
	--color-sidebar-foreground: var(--sidebar-foreground);
	--color-sidebar-primary: var(--sidebar-primary);
	--color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
	--color-sidebar-accent: var(--sidebar-accent);
	--color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
	--color-sidebar-border: var(--sidebar-border);
	--color-sidebar-ring: var(--sidebar-ring);

	/* Border radius */
	--radius: var(--radius);
}

/* Tiptap editor styles */
@layer base {
	/* Liveblocks portal z-index */
	.lb-portal {
		@apply z-30;
	}

	/* Tiptap editor styles to match liveblocks example */
	.tiptap:focus p[data-placeholder]::before {
		content: attr(data-placeholder);
		position: absolute;
		user-select: none;
		pointer-events: none;
		color: hsl(var(--foreground) / 0.4);
	}

	/* Typography styles */
	.tiptap h1 {
		font-size: 2rem;
		font-weight: 700;
		line-height: 1.2;
	}

	.tiptap h2 {
		font-size: 1.5rem;
		font-weight: 600;
		line-height: 1.2;
	}

	.tiptap h3 {
		font-size: 1.25rem;
		font-weight: 600;
		line-height: 1.2;
	}

	.tiptap h4 {
		font-size: 1rem;
		font-weight: 600;
		line-height: 1.2;
	}

	.tiptap h5 {
		font-size: 0.875rem;
		font-weight: 600;
		line-height: 1.2;
	}

	/* Blockquote styles */
	.tiptap blockquote {
		box-sizing: border-box;
		border-left: 0.25rem solid hsl(var(--foreground) / 0.25);
		padding-left: 1rem;
	}

	/* List styles */
	.tiptap ul {
		display: block;
		list-style-type: disc;
		margin-block-start: 1rem;
		margin-block-end: 1rem;
		margin-inline-start: 0px;
		margin-inline-end: 0px;
		padding-inline-start: 40px;
		unicode-bidi: isolate;
	}

	.tiptap ol {
		display: block;
		list-style-type: decimal;
		margin-block-start: 1rem;
		margin-block-end: 1rem;
		margin-inline-start: 0px;
		margin-inline-end: 0px;
		padding-inline-start: 40px;
		unicode-bidi: isolate;
	}

	.tiptap li {
		display: list-item;
		text-align: -webkit-match-parent;
		unicode-bidi: isolate;
	}

	.tiptap li::marker {
		unicode-bidi: isolate;
		font-variant-numeric: tabular-nums;
		text-transform: none;
		text-indent: 0px !important;
		text-align: start !important;
		text-align-last: start !important;
	}
}

/* App Styles */
@layer base {
	* {
		@apply border-border outline-ring/50;
	}

	html.dark {
		color-scheme: dark;
	}

	body {
		@apply bg-background text-foreground;
	}

	#root {
		height: 100vh;
		overflow: hidden;
	}

	/* App-specific utility styles */
	.logo {
		height: 6em;
		padding: 1.5em;
		will-change: filter;
		transition: filter 300ms;
	}

	.logo:hover {
		filter: drop-shadow(0 0 2em #646cffaa);
	}

	.logo.react:hover {
		filter: drop-shadow(0 0 2em #61dafbaa);
	}

	.card {
		padding: 2em;
	}

	.read-the-docs {
		color: #888;
	}

	@keyframes logo-spin {
		from {
			transform: rotate(0deg);
		}
		to {
			transform: rotate(360deg);
		}
	}

	@media (prefers-reduced-motion: no-preference) {
		a:nth-of-type(2) .logo {
			animation: logo-spin infinite 20s linear;
		}
	}
}
